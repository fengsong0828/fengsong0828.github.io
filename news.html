<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>最新动态 | LowAltitude Insight</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header>
        <div class="standard-container">
            <div class="nav-inner">
                <!-- 1. Logo (点击回首页) -->
                <a href="index.html" class="logo">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M22 12h-4l-3 9L9 3l-3 9H2"/>
                    </svg>
                    LowAltitude<span>Insight</span>
                </a>

                <!-- 2. 手机端菜单按钮 (汉堡图标) -->
                <button class="mobile-menu-btn" onclick="toggleMenu()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="3" y1="12" x2="21" y2="12"></line>
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <line x1="3" y1="18" x2="21" y2="18"></line>
                    </svg>
                </button>

                <!-- 3. 中间导航链接 -->
                <nav class="nav-links" id="navMenu">
                    <a href="index.html">首页</a>
                    <a href="news.html">资讯快报</a>
                    <a href="policies.html">政策法规</a>
                    <a href="tech.html">技术前沿</a>
                    <a href="companies.html">公司数据库</a>
                </nav>

                <!-- 4. 右侧功能按钮 -->
                <div class="header-actions">
                    <button class="btn btn-outline">搜索</button>
                    <button class="btn btn-primary">订阅/登录</button>
                </div>
            </div>
        </div>
    </header>


    <!-- 页面标题 -->
    <section class="page-hero">
        <div class="standard-container">
            <h1>行业资讯快报</h1>
            <p>汇聚全球低空经济最新情报</p>
        </div>
    </section>

    <div class="standard-container">
        <div class="main-layout-grid">
            <main>
                <!-- 列表 -->
                <div class="news-feed" id="news-container">
                    
                    <div style="text-align:center; padding:20px; color:#999;">正在加载最新资讯...</div>
                    <!-- 更多新闻项... -->
                </div>
            </main>

            <aside>
                <div class="sidebar-widget">
                    <div class="widget-title">热门标签</div>
                    <div style="display:flex; gap:8px; flex-wrap:wrap;">
                        <span class="tag">eVTOL</span><span class="tag">适航取证</span><span class="tag">无人机物流</span><span class="tag">空域管理</span>
                    </div>
                </div>
            </aside>
        </div>
    </div>

    <footer>
        <div class="standard-container">
            <div class="copyright">&copy; 2025 LowAltitude Insight.</div>
        </div>
    </footer>
    <script>function toggleMenu() { document.getElementById('navMenu').classList.toggle('active'); }</script>
    
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
    // =================配置区域=================
    // 1. 替换为你的 Project URL
    const supabaseUrl = 'https://cpvisbzlzatfdqakqsul.supabase.co'; 
    // 2. 替换为你的 anon key (public)
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNwdmlzYnpsemF0ZmRxYWtxc3VsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQzOTgwMTYsImV4cCI6MjA3OTk3NDAxNn0.R__eoUjpzFP9_SUxIVnM9T1zpl1pcBTGMzxXLf-Orcg';
    // 初始化客户端
    // ★★★ 修正点：这里改成了 supabase.createClient ★★★
    const _supabase = supabase.createClient(supabaseUrl, supabaseKey);
    // ===========================================

    document.addEventListener('DOMContentLoaded', async function() {
        const container = document.getElementById('news-container');

        // ★★★ 修正点：下面使用 _supabase 变量 ★★★
        const { data, error } = await _supabase
            .from('news')
            .select('*')
            .order('publish_date', { ascending: false });

        // ... (后面的渲染代码不用动) ...
        
        if (error) {
            console.error('加载出错:', error);
            container.innerHTML = '<p style="text-align:center; color:red;">加载失败，请看控制台。</p>';
            return;
        }

        if (!data || data.length === 0) {
            container.innerHTML = '<p style="text-align:center;">暂无数据。</p>';
            return;
        }

        container.innerHTML = '';

        data.forEach(item => {
            // ... (原本的渲染逻辑) ...
            const bgStyle = item.image_url 
                ? `background: #cbd5e1 url('${item.image_url}') center/cover;` 
                : `background: #cbd5e1;`;

            const html = `
                <article class="news-item">
                    <div class="news-image" style="${bgStyle}"></div>
                    <div class="news-content">
                        <h3><a href="news-detail.html?id=${item.id}">${item.title}</a></h3>
                        <div class="news-meta">
                            <span class="tag">${item.category}</span>
                            <span>${item.publish_date}</span>
                            <span style="margin-left:10px; color:#ccc;">${item.source || ''}</span>
                        </div>
                        <p style="font-size:0.9rem; color:#64748b; margin-top:8px;">${item.summary}</p>
                    </div>
                </article>
            `;
            container.innerHTML += html;
        });
    });
</script>
</body>
</html>